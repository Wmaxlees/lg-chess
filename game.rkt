#lang racket

(require "board.rkt")

(provide game%)

(define game%
  (class object%
    (init-field gametype)

    (define/public (initializeBoards)
      (case gametype
        [("RRetiEndgame") (init-r-reti-endgame)]
        [else (init-default)]))

    (define board (new board%))

    (define (init-r-reti-endgame)
      (send board set-bit-board white-pawn #b0000000000000000000001000000000000000000000000000000000000000000)
      (send board set-bit-board white-king #b1000000000000000000000000000000000000000000000000000000000000000)
      (send board set-bit-board black-pawn #b0000000000000000000000001000000000000000000000000000000000000000)
      (send board set-bit-board black-king #b0000000000000000000000010000000000000000000000000000000000000000))

    (define (init-default)
      ; White pieces
      (send board set-bit-board white-pawn   #b0000000000000000000000000000000000000000000000001111111100000000)
      (send board set-bit-board white-rook   #b0000000000000000000000000000000000000000000000000000000010000001)
      (send board set-bit-board white-knight #b0000000000000000000000000000000000000000000000000000000001000010)
      (send board set-bit-board white-bishop #b0000000000000000000000000000000000000000000000000000000000100100)
      (send board set-bit-board white-queen  #b0000000000000000000000000000000000000000000000000000000000010000)
      (send board set-bit-board white-king   #b0000000000000000000000000000000000000000000000000000000000001000)

      ; Black pieces
      (send board set-bit-board black-pawn   #b0000000011111111000000000000000000000000000000000000000000000000)
      (send board set-bit-board black-rook   #b1000000100000000000000000000000000000000000000000000000000000000)
      (send board set-bit-board black-knight #b0100001000000000000000000000000000000000000000000000000000000000)
      (send board set-bit-board black-bishop #b0010010000000000000000000000000000000000000000000000000000000000)
      (send board set-bit-board black-queen  #b0000100000000000000000000000000000000000000000000000000000000000)
      (send board set-bit-board black-king   #b0001000000000000000000000000000000000000000000000000000000000000))

    (define/public (get-board) board)

    (super-new)))